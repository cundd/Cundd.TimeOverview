<f:layout name="Default" />
{namespace ir=Iresults\Core\ViewHelpers}

This Template is responsible for creating a table of domain objects.

If you modify this template, do not forget to change the overwrite settings
in /Configuration/ExtensionBuilder/settings.yaml:
  Resources:
    Private:
      Templates:
        List.html: keep

Otherwise your changes will be overwritten the next time you save the extension in the extension builder

<f:section name="main">
<h1>Listing for Record</h1>

<f:flashMessages />

<!--
<f:comment>
<table class="tx_cunddtimeoverview table table-striped table-condensed">
	<tr>
		<th><f:translate>Start</f:translate></th>
		<th><f:translate>End</f:translate></th>
		<th><f:translate>Duration</f:translate></th>
		<th><f:translate>Comment</f:translate></th>
		<th><f:translate>Project title</f:translate></th>
		<th> </th>
		<th> </th>
	</tr>

	<f:for each="{records}" as="record">
		<tr>
			<td><f:link.action action="show" arguments="{record : record}"> <f:format.date format="Y-m-d H:i">{record.start}</f:format.date></f:link.action></td>
			<td><f:link.action action="show" arguments="{record : record}"> <f:format.date format="Y-m-d H:i">{record.end}</f:format.date></f:link.action></td>
			<td><f:link.action action="show" arguments="{record : record}"> {record.formattedDuration}</f:link.action></td>
			<td><f:link.action action="show" arguments="{record : record}"> {record.comment}</f:link.action></td>
			<td><f:link.action action="show" controller="project" arguments="{project : record.task.project}"> {record.task.project.title}</f:link.action></td>
			<td><f:link.action action="edit" arguments="{record : record}">Edit</f:link.action></td>
			<td><f:link.action action="delete" arguments="{record : record}">Delete</f:link.action></td>
		</tr>
	</f:for>
</table>
</f:comment>
-->


<table class="tx_cunddtimeoverview table table-striped table-condensed">
	<thead>
		<tr>
			<th><f:translate>Date</f:translate></th>
			<th><f:translate>Records</f:translate></th>
		</tr>
	</thead>

	<tbody>
		<f:for each="{dates}" as="currentDate">
			<tr>
				<td>
					<f:link.action action="calendar" arguments="{date : currentDate.date.timestamp}"> <f:format.date format="D Y-m-d">{currentDate.date}</f:format.date></f:link.action> <br />

					<f:format.number>{currentDate.isInHours}</f:format.number> of <f:format.number>{currentDate.shouldInHours}</f:format.number>


					{currentDate.differenceAsFormattedDateInterval}<br />

					<f:if condition="{currentDate.differenceInPercent} > 100">
						<f:then>
							<div class="progress progress-success">
								<div class="bar" style="width: {currentDate.differenceInPercent}%"></div>
							</div>
						</f:then>

						<f:else>
							<div class="progress progress-danger">
								<div class="bar" style="width: {currentDate.differenceInPercent}%"></div>
							</div>
						</f:else>
					</f:if>
				</td>
				<td>
					Number of records: <f:count>{currentDate.records}</f:count>

					<table class="table table-hover table-condensed">
						<tr>
							<th><f:translate>Start</f:translate></th>
							<th><f:translate>End</f:translate></th>
							<th><f:translate>Duration</f:translate></th>
							<th><f:translate>Comment</f:translate></th>
							<th><f:translate>Project title</f:translate></th>
						</tr>

						<f:for each="{currentDate.records}" as="record">
							<tr>
								<td><f:link.action action="show" arguments="{record : record}"> <f:format.date format="Y-m-d H:i">{record.start}</f:format.date></f:link.action></td>
								<td><f:link.action action="show" arguments="{record : record}"> <f:format.date format="Y-m-d H:i">{record.end}</f:format.date></f:link.action></td>
								<td><f:link.action action="show" arguments="{record : record}"> {record.formattedDuration}</f:link.action></td>
								<td><f:link.action action="show" arguments="{record : record}"> {record.comment}</f:link.action></td>
								<td><f:link.action action="show" controller="project" arguments="{project : record.task.project}"> {record.task.project.title}</f:link.action></td>
							</tr>
						</f:for>
					</table>

				</td>
			</tr>
		</f:for>
	</tbody>

	<tfoot>
		<tr>
			<td>
				{totalDifferenceHours} <br />
				{totalDifferenceFormatted}<br />
				<f:format.number>{totalActualHours}</f:format.number> of <f:format.number>{totalTargetHours}</f:format.number>


				<f:if condition="{totalDifferenceInPercent} > 100">
					<f:then>
						<div class="progress progress-success">
							<div class="bar" style="width: {totalDifferenceInPercent}%"></div>
						</div>
					</f:then>

					<f:else>
						<div class="progress progress-danger">
							<div class="bar" style="width: {totalDifferenceInPercent}%"></div>
						</div>
					</f:else>
				</f:if>
			</td>
			<td>
				Total number of records: <f:count>{records}</f:count>
			</td>
		</tr>
	</tfoot>
</table>



<f:form action="calendar" method="post">
	<f:form.select name="calendarMode" value="{calendarMode}" options="{calendarModes}" />
	<f:form.textfield name="date" value="{date}" placeholder="Enter date" />
	<f:form.submit value="Change view" class="btn" />
</f:form>

<f:link.action action="new">New Record</f:link.action>
</f:section>